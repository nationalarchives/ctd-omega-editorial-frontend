@*
 * Copyright (c) 2022 The National Archives
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy of
 * this software and associated documentation files (the "Software"), to deal in
 * the Software without restriction, including without limitation the rights to
 * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of
 * the Software, and to permit persons to whom the Software is furnished to do so,
 * subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS
 * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR
 * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER
 * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
 * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *@

@import uk.gov.nationalarchives.omega.editorial.models.{ User, EditSetEntry }
@import uk.gov.hmrc.govukfrontend.views.html.components._
@import uk.gov.hmrc.govukfrontend.views.html.components.implicits._
@import views.html.helper.CSRF
@import uk.gov.nationalarchives.omega.editorial.controllers.EditSetController._
@import uk.gov.nationalarchives.omega.editorial.services.EditSetPagination.EditSetPage
@import uk.gov.nationalarchives.omega.editorial.services.RowOrdering

@this(
  govukPagination: GovukPagination,
  govukTable: GovukTable,
)

@(
  user: User,
  title: String,
  heading: String,
  page: EditSetPage,
  ordering: RowOrdering,
)(implicit messages: Messages, request: Request[AnyContent])

@recordLink(ccr: String, oci: String) = {
    @defining("/edit-set/1/record/"+oci+"/edit") { hrefLink =>
        <a class="govuk-link govuk-link--no-visited-state" href=@hrefLink>@ccr</a>
    }
}


@template(Some(user), title) {

  <h1 class="govuk-heading-l">@heading</h1>

  @govukTable(Table(
      rows = page.entries.map {
        entry =>
            Seq(
                TableRow (
                    content = HtmlContent(recordLink(entry.ccr, entry.oci)),
                ),
                TableRow (
                    content = Text(entry.scopeAndContent),
                ),
                TableRow (
                    content = Text(entry.coveringDates),
                )
            )
      },
      head = Some(
          Seq(
              HeadCell(
                  content = Text(messages("edit-set.record.edit.ccr"))
              ),
              HeadCell(
                  content = Text(messages("edit-set.record.edit.scope-and-content"))
              ),
              HeadCell(
                  content = Text(messages("edit-set.record.edit.covering-dates"))
              )
          )
      ),
      caption = Some(
        messages(
          "edit-set.table-caption",
          page.numberOfFirstEntry.toString,
          page.numberOfLastEntry.toString,
          page.totalNumberOfEntries.toString
        )
      ),
      captionClasses = "govuk-table__caption--m",
      firstCellIsHeader = true
  ))

  @govukPagination(page.pagination)
}
